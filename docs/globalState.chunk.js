var O=Object.defineProperty;var M=(t,e,s)=>e in t?O(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var a=(t,e,s)=>M(t,typeof e!="symbol"?e+"":e,s);import{r as p,c as x}from"./index.js";class L{constructor(e,s){a(this,"onChange");a(this,"setValue",e=>this.onChange.forEach(s=>s(e)));a(this,"subscribe",e=>(e(this.val),this.onChange.push(e),()=>void(this.onChange=this.onChange.filter(s=>s!==e))));a(this,"use",e=>this.useState(e)[0]);a(this,"useState",e=>{const[s,n]=p.useState(this.val);p.useDebugValue(e??this.debugLabel),p.useEffect(()=>(this.onChange.push(n),()=>void(this.onChange=this.onChange.filter(o=>o!==n))),[]);const r=p.useCallback(o=>this.onChange.forEach(l=>l(o)),[]);return[s,r]});a(this,"useEffect",(e,s)=>{const n=p.useCallback(r=>this.onChange.forEach(o=>o(r)),[]);p.useEffect(()=>e(n),s)});this.val=e,this.debugLabel=s,this.onChange=[n=>void(this.val=typeof n=="function"?n(this.val):n)]}get private(){return this}get value(){return this.val}set value(e){this.setValue(e)}}function S(t,e){return new L(t,e)}const w={"404 Not Found":"404 Not Found","Redirect cancelled.":"Redirect cancelled.","Redirecting to the home page...":"Redirecting to the home page...","Go to Home page":"Go to Home page",Cancel:"Cancel",Home:"Home","Example users":"Example users",Features:"Features","Code features":"Code features","Table of contents":"Table of contents"},H=Object.freeze(Object.defineProperty({__proto__:null,en:w},Symbol.toStringTag,{value:"Module"})),g=t=>typeof t=="object"&&t!==null&&typeof t.fromString=="function"&&typeof t.toString=="function"&&typeof t.toJSON=="function",v=(t,e)=>{if(t===e)return t;if(g(t)){if(g(e))return t.toString()!==e.toString()?e:t;if(typeof e=="string")return t.fromString(e);throw new Error(`cleverMerge: b should be serializable or a string but is ${JSON.stringify(e)}`)}if(g(e)||typeof t!=typeof e||typeof t!="object"||typeof e!="object"||t===null||e===null)return e;const s=Array.isArray(t)?[...t]:{...t};let n=!1;Array.isArray(s)&&Array.isArray(e)&&s.length!==e.length&&(s.length=e.length,n=!0);for(const r in e){const o=r;o in t?(s[o]=v(t[o],e[o]),n||(n=s[o]!==t[o])):(s[o]=e[o],n=!0)}return n?s:t},P=t=>{const e=parseInt(t);return isNaN(e)?t:e};class k{constructor(){a(this,"proxyMap",new WeakMap);a(this,"createProxy",(e,s)=>{const n=new Proxy(e,s);return this.proxyMap.set(n,e),n});a(this,"getTarget",e=>this.proxyMap.get(e))}}const{createProxy:U,getTarget:b}=new k,C=(t,e)=>typeof t=="object"&&t!==null?U(t,{get:(s,n)=>{const r=t[n];return C(r,typeof r=="object"?e[n]=e[n]??{}:r)},set:(s,n,r)=>(e[Array.isArray(t)?P(n):n]=r,!0)}):t,N=(t,e)=>{for(const s in e){const n=e[s];if(n&&typeof n=="object"){const r=t?t[s]:void 0,o=b(n);o?e[s]=o:!Array.isArray(n)&&Object.keys(n).length===0?delete e[s]:N(r,n)}}return e},I=(t,e)=>{const s={},n=C(t,s);e(n);const r=N(t,s);return v(t,r)},E=(t,e)=>{if(g(t)){if(g(e))return t.toString()!==e.toString()?e:t;if(typeof e=="string")return t.fromString(e);throw new Error(`cleverMerge: b should be serializable or a string but is ${JSON.stringify(e)}`)}if(g(e)||typeof t!=typeof e)return e;if(typeof t!="object"||typeof e!="object"||t===null||e===null)return t!==e?e:t;if(Array.isArray(t)){if(!Array.isArray(e))return e;const r=[...t];let o=!1;return r.length=e.length,e.forEach((l,i)=>{r[i]=E(t[i],l),o||(o=r[i]!==t[i])}),o?r:t}const s={...t};let n=!1;for(const r in t)r in e?s[r]=E(t[r],e[r]):delete s[r],n||(n=s[r]!==t[r]);for(const r in e)r in t||(s[r]=e[r],n=!0);return n?s:t},y=(t,...e)=>`${t}(${e.join(", ")})`;class V{constructor(e,s){a(this,"appStore");a(this,"updateName","");a(this,"onUpdate");a(this,"isSetAppEnabledStore",S(!0).private);a(this,"setAppValue",()=>{});a(this,"setApp",this.setApp_.bind(this));a(this,"setPartialApp",this.setPartialApp_.bind(this));a(this,"setAppWithUpdate",this.setAppWithUpdate_.bind(this));a(this,"useInit",(e={})=>{const{devtoolsConfig:s={trace:!0,traceLimit:6},onUpdate:n,autoEnableSetApp:r=!0}=e,[o,l]=this.appStore.private.useState(),[i,c]=this.isSetAppEnabledStore.useState(),_=p.useRef(0),h=p.useMemo(()=>{var u;return s&&((u=window.__REDUX_DEVTOOLS_EXTENSION__)==null?void 0:u.connect(s))},[]);return p.useEffect(()=>{const u=f=>{if(!i)return;if(typeof f=="function")return u(f(this.appStore.private.value));h==null||h.send({type:this.updateName},{value:f}),_.current++;const A=l(f);return this.setAppValue=u,A};this.setAppValue=u},[i]),p.useEffect(()=>(this.onUpdate=n,h==null||h.init({value:o}),h==null?void 0:h.subscribe(u=>{if(u.type==="DISPATCH"&&u.state){u.payload.actionId!==_.current?c(!1):r&&c(!0);const f=JSON.parse(u.state);f.value&&l(A=>E(A,f.value))}})),[]),o});a(this,"useSetAppEnabled",()=>this.isSetAppEnabledStore.useState());this.appStore=S(e,s)}setApp_(e,...s){var o;const[n,r]=s.length===2?s:[[],s[0]];this.updateName=y(e,n),this.setAppValue(r),(o=this.onUpdate)==null||o.call(this,{functionName:e,functionParams:n,computedName:this.updateName})}setPartialApp_(e,...s){var o;const[n,r]=s.length===2?s:[[],s[0]];this.updateName=y(e,n),this.setAppValue(l=>v(l,r)),(o=this.onUpdate)==null||o.call(this,{functionName:e,functionParams:n,computedName:this.updateName})}setAppWithUpdate_(e,...s){var o;const[n,r]=s.length===2?s:[[],s[0]];this.updateName=y(e,n),this.setAppValue(l=>I(l,r)),(o=this.onUpdate)==null||o.call(this,{functionName:e,functionParams:n,computedName:this.updateName})}}const F=()=>`${window.location.pathname}${window.location.search}`,R="template_globalState",$=()=>{const t=JSON.parse(localStorage.getItem(R)??"{}");return{lang:t.lang??"en",colorScheme:t.colorScheme??"dark",isAsideOpened:t.isAsideOpened??!1,isNavbarOpened:t.isNavbarOpened??!1,usersFilter:t.usersFilter??""}},d=$(),J=S(d),{appStore:D,setAppWithUpdate:m,useInit:z,useSetAppEnabled:G}=new V({url:F().replace(x.BASE_URL,""),lang:{value:d.lang,isLoading:!1},colorScheme:{value:d.colorScheme,isLoading:!1},wakeLock:{isEnabled:!1,isLoading:!1},errorMessage:null,shell:{isAboveXl:!1,isAboveMd:!1,aside:{isOpened:d.isAsideOpened},navbar:{isOpened:d.isNavbarOpened},main:{isScrollable:!1}},users:{all:[],isLoading:!1,filter:d.usersFilter}}),X=()=>D.use(),T=S(w),B=()=>T.use(),K=S(null),Y=(t,{functionName:e,functionParams:s=[],onUpdateLoading:n,onSuccess:r,onError:o})=>{const l=`${e}Loading`;return m(l,s,i=>n(i,!0)),t.then(i=>{m(e,s,c=>{c.errorMessage=null,r(c,i),n(c,!1)})}).catch(i=>{m(e,s,c=>{c.errorMessage=typeof i=="object"&&i&&"message"in i?i.message:"Unknown error",o==null||o(c),n(c,!1)})})};export{R as L,D as a,z as b,G as c,B as d,H as e,Y as h,J as l,K as m,m as s,T as t,X as u};
